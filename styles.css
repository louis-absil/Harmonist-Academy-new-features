
:root {
    --bg: #0f172a;
    --panel: #1e293b;
    --panel-border: rgba(255,255,255,0.08);
    --primary: #6366f1;
    --primary-glow: rgba(99, 102, 241, 0.4);
    --accent: #d946ef;
    --success: #10b981;
    --warning: #f59e0b;
    --error: #ef4444;
    --gold: #fbbf24;
    --cyan: #06b6d4; /* LAB THEME */
    --matrix: #22c55e;
    --text: #f8fafc;
    --text-dim: #94a3b8;
    --font: 'Segoe UI', system-ui, -apple-system, sans-serif;
    --radius: 16px;
}

/* --- NO SCROLLBARS (Version Totale) --- */

/* Pour Chrome, Safari, Edge, Opera */
::-webkit-scrollbar {
    display: none !important;
    width: 0 !important;
    height: 0 !important;
}

/* Pour Firefox */
* {
    scrollbar-width: none !important;
}

/* Pour IE/Legacy */
body {
    -ms-overflow-style: none;
}

* { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; outline: none; }

body {
    background-color: var(--bg);
    color: var(--text);
    font-family: var(--font);
    margin: 0; padding: 0;
    height: 100dvh; width: 100vw; overflow: hidden;
    display: flex; justify-content: center;
    overscroll-behavior: none; 
    transition: background-color 1s ease;
}

/* --- CODEX 2.0 TERMINAL STYLES --- */
.codex-terminal {
    background: #0f172a !important; /* Force dark bg */
    width: 95% !important; max-width: 800px !important; 
    height: 90vh !important; max-height: 90vh !important;
    padding: 0 !important; overflow: hidden !important;
    display: flex; flex-direction: column;
}

.codex-layout {
    display: flex; height: 100%; width: 100%;
}

/* SIDEBAR TABS */
.codex-sidebar {
    width: 80px; background: rgba(0,0,0,0.2);
    border-right: 1px solid var(--panel-border);
    display: flex; flex-direction: column; align-items: center;
    padding: 20px 0; gap: 15px; z-index: 10;
}
.codex-logo { font-size: 2rem; margin-bottom: 20px; filter: drop-shadow(0 0 10px rgba(255,255,255,0.2)); }
.codex-tab {
    background: transparent; border: none; color: var(--text-dim);
    display: flex; flex-direction: column; align-items: center; gap: 5px;
    padding: 10px 5px; cursor: pointer; transition: all 0.2s;
    width: 100%; position: relative;
}
.codex-tab:hover { color: white; }
.codex-tab.active { color: var(--gold); }
.codex-tab.active::after {
    content: ''; position: absolute; right: 0; top: 10%; bottom: 10%; width: 3px;
    background: var(--gold); border-radius: 2px 0 0 2px;
    box-shadow: -2px 0 10px rgba(251, 191, 36, 0.5);
}
.tab-icon { font-size: 1.5rem; }
.tab-label { font-size: 0.6rem; text-transform: uppercase; font-weight: 700; }
.codex-close { background: rgba(255,255,255,0.05); border: none; color: var(--text-dim); width: 40px; height: 40px; border-radius: 50%; font-size: 1.2rem; cursor: pointer; transition: 0.2s; }
.codex-close:hover { background: rgba(239, 68, 68, 0.2); color: var(--error); }

/* CONTENT AREA */
.codex-content-area { flex: 1; position: relative; overflow: hidden; background: radial-gradient(circle at top right, #1e293b 0%, #0f172a 100%); }

.codex-grid-container {
    padding: 20px; 
    overflow-y: auto; 
    height: 100%;
    display: grid; 
    /* 1. Taille intelligente : remplit l'espace avec des cartes de 140px minimum */
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    /* 2. Gestion de la hauteur : s'adapte au contenu pour Ã©viter l'Ã©crasement */
    grid-auto-rows: max-content;
    gap: 20px; 
    align-content: start;
    /* 3. SÃ©curitÃ© : empÃªche les dÃ©bordements horizontaux */
    width: 100%;
}
.codex-section-title {
    grid-column: 1 / -1; margin: 10px 0 5px 0;
    font-size: 0.75rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1px;
    border-bottom: 1px solid var(--panel-border); padding-bottom: 5px;
}
.codex-locked-msg {
    grid-column: 1 / -1; text-align: center; color: var(--text-dim);
    margin-top: 50px; font-style: italic; border: 1px dashed var(--panel-border); padding: 20px; border-radius: 12px;
}

/* CODEX DETAIL VIEW */
.codex-detail-container {
    position: absolute; inset: 0; background: var(--bg);
    display: flex; flex-direction: column;
    z-index: 20; animation: slideInRight 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}
@keyframes slideInRight { from{transform:translateX(50%);opacity:0} to{transform:translateX(0);opacity:1} }

.cd-nav-bar {
    height: 50px; border-bottom: 1px solid var(--panel-border);
    display: flex; align-items: center; padding: 0 15px; flex-shrink: 0;
}
.cd-back-btn { background: none; border: none; color: var(--primary); font-weight: 700; cursor: pointer; font-size: 0.9rem; }
.cd-close-btn { background: none; border: none; font-size: 1.2rem; color: var(--text-dim); cursor: pointer; }

.cd-scroll-content { flex: 1; overflow-y: auto; padding: 20px; max-width: 600px; margin: 0 auto; width: 100%; }

.cd-header-hero { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
.cd-hero-icon { font-size: 3rem; background: rgba(255,255,255,0.05); padding: 10px; border-radius: 16px; box-shadow: 0 0 20px rgba(0,0,0,0.2); }
.cd-hero-text h2 { margin: 0; font-size: 2rem; color: white; line-height: 1; }
.cd-hero-text span { color: var(--gold); text-transform: uppercase; letter-spacing: 1px; font-size: 0.8rem; font-weight: 700; }

.cd-tags-row { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px; }
.codex-chip { 
    background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); 
    color: #a5b4fc; font-size: 0.7rem; padding: 4px 10px; border-radius: 20px; 
}

.cd-section { margin-bottom: 20px; line-height: 1.6; font-size: 0.95rem; color: #cbd5e1; }
.cd-flavor { font-style: italic; border-left: 3px solid var(--gold); padding-left: 15px; color: #e2e8f0; font-size: 1rem; }
.cd-theory { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 12px; }
.cd-examples { margin-top: 15px; font-size: 0.85rem; }
.cd-examples ul { margin: 5px 0 0 20px; padding: 0; color: var(--text-dim); }

.cd-coach-box {
    background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(15, 23, 42, 0.8));
    border: 1px solid rgba(255,255,255,0.1); padding: 15px; border-radius: 12px;
    margin-top: 10px;
}
.coach-head { font-weight: 800; color: var(--success); margin-bottom: 5px; text-transform: uppercase; font-size: 0.75rem; }

/* RESPONSIVE CODEX (MOBILE) */
@media (max-width: 600px) {
    .codex-layout { flex-direction: column-reverse; }
    
    /* Barre de navigation du bas */
    .codex-sidebar { 
        width: 100%; height: 60px; flex-direction: row; padding: 0 10px;
        border-right: none; border-top: 1px solid var(--panel-border);
        justify-content: space-around;
        flex-shrink: 0; /* EmpÃªche l'Ã©crasement de la barre */
    }
    
    .codex-logo, .codex-close { display: none; }
    .codex-tab { height: 100%; justify-content: center; width: auto; }
    .codex-tab.active::after { top: auto; bottom: 0; left: 10%; right: 10%; height: 3px; width: auto; }
    .cd-hero-text h2 { font-size: 1.5rem; }

    /* --- CORRECTIF GRILLE MOBILE --- */
    .codex-grid-container {
        display: grid;
        /* Force 2 colonnes Ã©gales, quoi qu'il arrive */
        grid-template-columns: repeat(2, 1fr); 
        gap: 10px; /* Espace rÃ©duit pour gagner de la place */
        padding: 10px;
        padding-bottom: 80px; /* Espace pour scroller au dessus du menu */
    }
    
    /* Titres de section sur toute la largeur */
    .codex-section-title {
        grid-column: 1 / -1; 
        margin-top: 15px;
    }

    /* Ajustement de la taille du texte dans les cartes pour le mobile */
    .codex-card-symbol { font-size: 1.5rem; margin-bottom: 2px; }
    .codex-card-title { font-size: 0.65rem; }
}

/* --- AJOUT : BOUTON FERMER MOBILE --- */
.codex-mobile-close {
    position: absolute;
    top: 10px;
    right: 15px;
    background: rgba(0, 0, 0, 0.6);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.2);
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 50; /* Au-dessus du contenu */
    font-weight: bold;
    backdrop-filter: blur(4px);
}

/* --- LAB THEME & GRID --- */
.grid-lab {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr 1fr; /* Header, Row 1, Row 2 */
    gap: 8px;
    height: 100%; /* Fill the panel height */
    align-content: stretch; 
}

.grid-lab .pad {
    height: 100%; 
    min-height: 0; 
}

.lab-header {
    font-size: 0.6rem;
    font-weight: 900;
    color: var(--cyan);
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 1px;
    padding-bottom: 4px;
    border-bottom: 1px solid rgba(6, 182, 212, 0.3);
    margin-bottom: 2px;
    display: flex; align-items: center; justify-content: center;
}

.lab-tag {
    font-size: 0.55rem;
    background: rgba(0,0,0,0.3);
    padding: 2px 6px;
    border-radius: 4px;
    color: var(--text-dim);
    margin-top: 4px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    pointer-events: none;
}

/* QUIZ SPECIFIC LAB TAG SIZE */
.quiz-btn .lab-tag {
    font-size: 0.9rem; 
    background: rgba(255, 255, 255, 0.1);
    color: var(--cyan);
    margin-top: 8px;
    padding: 4px 10px;
    font-weight: 900;
    border: 1px solid rgba(6, 182, 212, 0.3);
}

.lab-contracted {
    box-shadow: inset 0 0 15px rgba(245, 158, 11, 0.1), 0 0 10px rgba(245, 158, 11, 0.1) !important;
}
.lab-contracted.selected {
    box-shadow: inset 0 0 20px rgba(245, 158, 11, 0.3), 0 0 15px rgba(245, 158, 11, 0.4) !important;
    border-color: var(--warning) !important;
}

.lab-expanded {
    box-shadow: inset 0 0 15px rgba(99, 102, 241, 0.1), 0 0 10px rgba(99, 102, 241, 0.1) !important;
}
.lab-expanded.selected {
    box-shadow: inset 0 0 20px rgba(99, 102, 241, 0.3), 0 0 15px rgba(99, 102, 241, 0.4) !important;
    border-color: var(--primary) !important;
}

/* --- MASTERY AURAS (DYNAMIC) --- */

.tier-dynamic {
    transition: all 0.5s ease;
}

/* Header Specifics */
.header-left.tier-dynamic .rank-icon {
    text-shadow: 0 0 15px var(--tier-shadow);
}
.header-left.tier-dynamic .rank-title {
    color: var(--tier-color);
    text-shadow: 0 0 10px var(--tier-shadow);
}

/* Modal Specifics */
#modalProfile.tier-dynamic .profile-avatar {
    border-color: var(--tier-color);
    box-shadow: 0 0 20px var(--tier-shadow), inset 0 0 20px var(--tier-shadow);
    text-shadow: 0 0 15px var(--tier-shadow);
}

#modalProfile.tier-dynamic .profile-subtitle {
    color: var(--tier-color);
    text-shadow: 0 0 5px var(--tier-shadow);
}

#modalProfile.tier-dynamic .rank-icon {
    text-shadow: 0 0 15px var(--tier-shadow);
}

/* Stars Animation & Filter */
.tier-star {
    color: var(--tier-color);
    filter: drop-shadow(0 0 4px var(--tier-shadow));
    display: inline-block;
    animation: pulseStar 3s infinite;
}

/* NEW: LOCATION BADGE IN PROFILE */
.profile-location-badge {
    margin-top: 8px;
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    background: rgba(0,0,0,0.3);
    border: 1px solid currentColor;
    padding: 3px 8px;
    border-radius: 6px;
    font-weight: 800;
    opacity: 0.8;
}

/* NEW: FOOTER LORE ROW */
.profile-footer-lore {
    margin-top: 20px;
    padding-top: 10px;
    border-top: 1px solid rgba(255,255,255,0.05);
    font-size: 0.7rem;
    color: var(--text-dim);
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 1px;
    opacity: 0.8;
}

@keyframes pulseStar {
    0% { transform: scale(1); opacity: 0.8; }
    50% { transform: scale(1.2); opacity: 1; }
    100% { transform: scale(1); opacity: 0.8; }
}

@keyframes pulseAura { 0% { opacity: 0.8; } 50% { opacity: 1; filter: brightness(1.2); } 100% { opacity: 0.8; } }

/* VIGNETTE STRESS EFFECT */
.vignette-overlay {
    position: fixed; inset: 0; pointer-events: none; z-index: 80;
    background: radial-gradient(circle, transparent 50%, rgba(239, 68, 68, 0) 70%);
    transition: background 0.5s ease;
}
.vignette-overlay.stress {
    background: radial-gradient(circle, transparent 40%, rgba(239, 68, 68, 0.4) 90%);
    animation: heartbeat 1s infinite;
}

/* BADGE RIBBON */
.badge-ribbon {
    position: fixed; top: -100px; left: 50%; transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.75);
    backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
    border: 1px solid var(--gold);
    color: white; padding: 10px 24px; border-radius: 50px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5), 0 0 15px rgba(251, 191, 36, 0.3);
    z-index: 2100; /* High Z-Index */
    display: flex; align-items: center; gap: 12px; font-weight: 800;
    font-size: 0.9rem; transition: top 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    white-space: nowrap;
}
.badge-ribbon.show { top: 20px; }
.badge-ribbon-icon { font-size: 1.4rem; animation: pulseFire 1.5s infinite; }
.badge-txt-gold { color: var(--gold); text-transform: uppercase; letter-spacing: 0.5px; margin-right: 5px; }

/* BADGE LIGHTBOX (GLASSMORPHISM) */
.badge-lightbox .modal {
    background: rgba(30, 41, 59, 0.75);
    backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
}
.badge-lightbox .unlocked {
    color: var(--success);
    border: 1px solid rgba(16, 185, 129, 0.3);
    background: rgba(16, 185, 129, 0.1);
}
.badge-lightbox .locked {
    color: var(--text-dim);
    border: 1px solid rgba(255,255,255,0.1);
}

/* CONFETTI */
.confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 90; }

.app-container {
    width: 100%; max-width: 1200px; height: 100%;
    display: flex; flex-direction: column;
    padding: 10px; gap: 8px; position: relative;
    padding-bottom: max(20px, env(safe-area-inset-bottom));
    z-index: 85; 
}

/* HEADER */
header {
    display: flex; justify-content: space-between; align-items: center;
    padding: 8px 12px; background: var(--panel); border-radius: var(--radius);
    border: 1px solid var(--panel-border); flex-shrink: 0; 
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); gap: 10px; min-height: 50px;
    position: relative; 
    z-index: 1000; 
}
.header-left { display: flex; align-items: center; gap: 10px; overflow: hidden; cursor: pointer; transition: opacity 0.2s; }
.header-left:active { opacity: 0.7; }
.rank-icon { font-size: 1.5rem; flex-shrink: 0; }
.rank-text { display: flex; flex-direction: column; line-height: 1.1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.rank-title { font-weight: 800; color: var(--gold); font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.5px; transition: 0.3s; }
.lvl-pill { font-size: 0.7rem; color: var(--text-dim); background: rgba(0,0,0,0.2); padding: 1px 6px; border-radius: 4px; align-self: flex-start; margin-bottom: 2px; }
.mastery-stars { display: flex; gap: 2px; font-size: 0.8rem; margin-left: 6px; }
.xp-container { position: absolute; bottom: 0; left: 0; width: 100%; height: 3px; background: rgba(0,0,0,0.3); }
.xp-fill { height: 100%; background: linear-gradient(90deg, var(--primary), var(--accent)); width: 0%; transition: width 0.5s ease-out; }

.header-right { display: flex; align-items: center; gap: 12px; flex-shrink: 0; }
.stats-cluster { display: flex; gap: 6px; align-items: center; }
.stat-badge { 
    background: rgba(0,0,0,0.3); border: 1px solid var(--panel-border); 
    padding: 4px 8px; border-radius: 8px; text-align: center;
    display: flex; flex-direction: column; justify-content: center;
    min-width: 40px; position: relative;
}
.stat-val { font-weight: 800; font-size: 0.85rem; color: white; }
.stat-lbl { font-size: 0.45rem; text-transform: uppercase; color: var(--text-dim); letter-spacing: 0.5px; margin-bottom: 2px;}

.score-group { display: none; } 
.score-group.active { display: flex; flex-direction: column; }
.score-main { font-size: 0.9rem; font-weight: 900; color: var(--gold); line-height: 1; }
.score-sub { font-size: 0.5rem; color: var(--text-dim); margin-top: 2px; }

.streak-fire { color: #ef4444; text-shadow: 0 0 10px #ef4444; animation: pulseFire 1s infinite; }
.streak-super { color: #d946ef; text-shadow: 0 0 15px #d946ef; animation: pulseFire 0.5s infinite; }

.header-actions { display: flex; gap: 5px; padding-left: 10px; border-left: 1px solid var(--panel-border); }
.icon-btn { background: transparent; border: none; font-size: 1.3rem; cursor: pointer; padding: 5px; border-radius: 8px; transition: background 0.2s; opacity: 0.8; }
.icon-btn:hover { background: rgba(255,255,255,0.1); opacity: 1; }

/* TOOLS */
.tools-bar { display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; padding: 0 5px; height: 40px; position: relative; }
.mode-selector { background: var(--panel); padding: 3px; border-radius: 20px; display: flex; border: 1px solid var(--panel-border); }
.mode-opt { padding: 4px 10px; border-radius: 16px; font-size: 0.7rem; font-weight: 700; color: var(--text-dim); cursor: pointer; transition: 0.2s; position: relative; }
.mode-opt.active { background: var(--primary); color: white; box-shadow: 0 2px 10px rgba(99, 102, 241, 0.3); }
.mode-opt.locked { opacity: 0.5; cursor: not-allowed; }
.mode-opt.locked:after { content: 'ðŸ”’'; font-size: 0.6rem; position: absolute; top: -5px; right: -5px; }

.vis-container { flex: 1; margin: 0 10px; height: 100%; background: rgba(0,0,0,0.2); border-radius: 10px; position: relative; overflow: hidden; border: 1px solid var(--panel-border); display: flex; align-items: center; justify-content: center; }
canvas { width: 100%; height: 100%; position: absolute; top:0; left:0; }
#visualizer { opacity: 0.5; }
#pianoCanvas { opacity: 0; transition: opacity 0.5s ease; z-index: 5; pointer-events: none; }
#pianoCanvas.show { opacity: 1; }

.sprint-bar-container { position: absolute; bottom: 0; left: 0; right: 0; height: 6px; background: transparent; overflow: hidden; border-radius: 0 0 10px 10px; display: none; }
.sprint-bar-fill { height: 100%; width: 100%; transform-origin: left; transition: transform 0.1s linear, background-color 0.3s; }
.sprint-bar-fill.easy { background: #10b981; }
.sprint-bar-fill.med { background: #f59e0b; box-shadow: 0 0 10px #f59e0b; }
.sprint-bar-fill.hard { background: #ef4444; box-shadow: 0 0 15px #ef4444; }
.tools-bar.sprint-active .sprint-bar-container { display: block; }

.feedback-msg { z-index: 2; font-weight: 800; font-size: 0.9rem; text-shadow: 0 2px 4px rgba(0,0,0,0.8); transition: 0.2s; white-space: nowrap;}
.feedback-msg.correct { color: var(--success); animation: pop 0.2s; }
.feedback-msg.wrong { color: var(--error); animation: shake 0.3s; }
.feedback-msg.warning { color: var(--warning); }
.timer-badge { font-variant-numeric: tabular-nums; background: var(--primary); color: white; padding: 4px 10px; border-radius: 8px; font-weight: 800; font-size: 0.9rem; box-shadow: 0 0 10px var(--primary-glow); display: none; white-space: nowrap; }
.lives { font-size: 0.8rem; margin-left: 5px; opacity: 0.8; }

/* --- STUDIO MODE (V5.1) --- */
.studio-panel {
    background: var(--panel);
    border: 1px solid var(--panel-border);
    border-radius: var(--radius);
    padding: 8px;
    margin-bottom: 5px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.studio-controls {
    display: flex;
    gap: 10px;
    align-items: center;
}

.bass-octave-ctrl {
    display: flex;
    flex-direction: column;
    align-items: center;
    background: rgba(0,0,0,0.3);
    border-radius: 8px;
    padding: 2px;
}

.oct-btn {
    background: transparent;
    border: none;
    color: var(--text-dim);
    font-weight: 900;
    cursor: pointer;
    padding: 2px 8px;
}
.oct-btn:hover { color: white; }
.oct-lbl { font-size: 0.5rem; color: var(--text-dim); }

.piano-strip {
    flex: 1;
    display: flex;
    height: 50px;
    gap: 2px;
    position: relative;
    background: #000;
    padding: 2px;
    border-radius: 4px;
}

.piano-key {
    flex: 1;
    border: none;
    border-radius: 0 0 3px 3px;
    cursor: pointer;
    font-size: 0.6rem;
    font-weight: 700;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding-bottom: 4px;
    position: relative;
}

.piano-key.white {
    background: #e2e8f0;
    color: #334155;
    z-index: 1;
}
.piano-key.white.selected { background: var(--primary); color: white; }

.piano-key.black {
    background: #1e293b;
    height: 60%;
    width: 8%; /* visually accurate */
    position: absolute;
    z-index: 2;
    border-radius: 0 0 2px 2px;
    margin-left: -4%; /* center over crack */
}
/* Manual positioning for black keys based on 12-key layout logic */
#pk-1 { left: 14.28%; }
#pk-3 { left: 28.57%; }
#pk-6 { left: 57.14%; }
#pk-8 { left: 71.42%; }
#pk-10 { left: 85.71%; }

.piano-key.black.selected { background: var(--accent); box-shadow: 0 0 10px var(--accent); }

.studio-timeline {
    height: 40px;
    background: rgba(0,0,0,0.3);
    border-radius: 8px;
    display: flex;
    align-items: center;
    padding: 0 10px;
    overflow-x: auto;
    white-space: nowrap;
    border: 1px dashed var(--panel-border);
}

.timeline-placeholder {
    width: 100%; text-align: center; color: var(--text-dim); font-size: 0.7rem; font-style: italic;
}

.timeline-item {
    background: var(--panel);
    border: 1px solid var(--panel-border);
    padding: 4px 8px;
    border-radius: 6px;
    margin-right: 5px;
    font-size: 0.7rem;
    display: flex;
    align-items: center;
    gap: 5px;
    cursor: pointer;
}
.timeline-item:hover { border-color: var(--gold); }
.timeline-item-del { color: var(--error); font-weight: 900; cursor: pointer; padding: 0 4px; }


/* GAME AREA */
.game-area { 
    flex: 1; 
    min-height: 0; 
    display: grid; 
    grid-template-columns: 1.5fr 1fr; 
    gap: 10px; 
    overflow-y: auto; 
    overflow-x: hidden; /* EmpÃªche le scroll horizontal */
    padding: 5px; /* Donne de l'air pour le scale */
}
.game-area.quiz-mode { grid-template-columns: 1fr; } 

.panel { background: var(--panel); border: 1px solid var(--panel-border); border-radius: var(--radius); padding: 8px; display: flex; flex-direction: column; box-shadow: inset 0 0 20px rgba(0,0,0,0.2); transition: opacity 0.3s; height: 100%; overflow: hidden; }
.panel-label { font-size: 0.65rem; text-transform: uppercase; color: var(--text-dim); font-weight: 800; letter-spacing: 1px; margin-bottom: 6px; display: flex; justify-content: space-between; flex-shrink: 0; align-items: center; }

/* --- SCHÃ‰MA CLAVIER VISUEL POUR RACCOURCIS --- */
.keyboard-shortcut-visual {
    display: flex;
    gap: 2px;
    align-items: center;
}

.keyboard-key {
    width: 20px;
    height: 20px;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.6rem;
    font-weight: 700;
    color: var(--text-dim);
    transition: all 0.2s ease;
}

.keyboard-key.highlight {
    background: var(--primary);
    border-color: var(--primary);
    color: white;
    box-shadow: 0 0 8px rgba(99, 102, 241, 0.4);
}

/* Masquer le schÃ©ma et les textes de raccourcis en mode mobile */
@media (max-width: 768px) {
    .keyboard-shortcut-visual {
        display: none !important;
    }
    .shortcuts-text-mobile {
        display: none !important;
    }
}

/* En desktop, masquer le texte et afficher le schÃ©ma */
@media (min-width: 769px) {
    .shortcuts-text-mobile {
        display: none;
    }
}

/* GENERIC GRID STYLES */
.pad-grid { 
    display: grid; gap: 6px; flex: 1; min-height: 0; 
}

.grid-c { 
    grid-template-columns: repeat(3, 1fr); 
    grid-auto-rows: 1fr; /* Stretch rows evenly */
}
.grid-i { 
    grid-template-columns: repeat(2, 1fr); 
    grid-auto-rows: 1fr; /* Stretch rows evenly */
}

/* BOUTONS */
.pad { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05); border-radius: 10px; cursor: pointer; position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1); height: 100%; width: 100%; min-height: 40px; }
.pad:active { transform: scale(0.96); }
.pad:hover { background: rgba(255,255,255,0.06); border-color: rgba(255,255,255,0.1); }

/* RANKS STYLING */
.pad.rank-bronze { 
    border-color: #b45309; color: #fdba74; 
    background: linear-gradient(145deg, rgba(180, 83, 9, 0.15), rgba(67, 20, 7, 0.3)); 
    box-shadow: inset 1px 1px 0 rgba(255,255,255,0.15), inset -1px -1px 0 rgba(0,0,0,0.4); 
}

.pad.rank-silver { 
    border-color: #e2e8f0; color: #ffffff; 
    background: linear-gradient(135deg, rgba(148, 163, 184, 0.4), rgba(51, 65, 85, 0.6)); 
    box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.1), 0 0 10px rgba(148, 163, 184, 0.3), inset 1px 1px 0 rgba(255,255,255,0.3); 
    text-shadow: 0 0 8px rgba(255, 255, 255, 0.6);
}

.pad.rank-gold { 
    border-color: #fbbf24; color: #fbbf24; 
    background: linear-gradient(145deg, rgba(251, 191, 36, 0.15), rgba(120, 53, 15, 0.3)); 
    box-shadow: inset 1px 1px 0 rgba(255,255,255,0.3), inset -1px -1px 0 rgba(0,0,0,0.4), 0 0 10px rgba(251, 191, 36, 0.15); 
    text-shadow: 0 0 10px rgba(251, 191, 36, 0.4); 
}

.pad.selected { background: rgba(99, 102, 241, 0.25) !important; border-color: var(--primary) !important; color: white !important; box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.4) !important; text-shadow: none !important; }
.pad.wrong { border-color: var(--error) !important; color: var(--error) !important; background: transparent !important; box-shadow: none !important; opacity: 0.4; }
.pad.correct, .pad.correction { border-color: #fcd34d !important; background: rgba(251, 191, 36, 0.3) !important; color: #fff !important; box-shadow: 0 0 0 2px #fbbf24, 0 0 30px rgba(251, 191, 36, 0.6) !important; text-shadow: 0 0 10px rgba(251, 191, 36, 1) !important; animation: pulseCorrection 1.5s infinite; z-index: 10; }
.pad.playing, .quiz-btn.playing { transform: scale(0.95) !important; border-color: white !important; background: rgba(255,255,255,0.3) !important; box-shadow: 0 0 20px white !important; color: white !important; transition: 0s !important; }
.pad-main { font-size: 1.5rem; font-weight: 900; font-family: monospace; pointer-events: none; letter-spacing: -0.5px; }
.pad-sub { font-size: 0.85rem; font-weight: 700; opacity: 0.8; margin-top: 0px; pointer-events: none; }

/* FIGURED BASS STYLE UNIFIED */
.figured-bass {
    display: inline-flex;
    flex-direction: column;
    justify-content: center;
    line-height: 0.85;
    font-weight: 900;
    font-size: 1.1em;
    vertical-align: middle;
    color: inherit;
}

.figured-bass.quiz-huge {
    font-size: 2.8rem;
    line-height: 0.9;
    text-shadow: 0 2px 10px rgba(0,0,0,0.5);
}

/* QUIZ AREA */
#quizArea { display: none; flex-direction: column; height: 100%; gap: 10px; }
.quiz-card { background: rgba(0,0,0,0.2); border: 1px solid var(--panel-border); border-radius: 16px; padding: 20px; flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
.quiz-target { font-size: 4.5rem; font-weight: 900; color: white; margin-bottom: 5px; text-shadow: 0 2px 10px rgba(0,0,0,0.5); }
.quiz-target span { color: var(--primary); }
.quiz-hint-txt { font-size: 1rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1px; }
.quiz-options { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; height: 120px; flex-shrink: 0;}
.quiz-btn { background: var(--panel); border: 2px solid var(--panel-border); border-radius: 16px; font-size: 2rem; font-weight: 900; color: var(--text-dim); cursor: pointer; transition: all 0.2s; position: relative; overflow: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; }
.quiz-btn:active { transform: scale(0.95); }
.quiz-btn.selected { border-color: var(--primary); color: white; background: rgba(99, 102, 241, 0.1); }
.quiz-btn.correct { border-color: var(--success); background: var(--success); color: white; text-shadow: 0 2px 5px rgba(0,0,0,0.3); }
.quiz-btn.wrong { border-color: var(--error); color: var(--error); opacity: 0.5; }
.quiz-btn span.reveal { display: block; font-size: 1.1rem; font-weight: 700; margin-top: 5px; opacity: 1; color: var(--text); }
.quiz-btn.correct span.reveal, .quiz-btn.selected span.reveal { color: white; }

/* LAB MODE QUIZ OVERRIDES */
.quiz-btn.lab-mode { border-color: rgba(6, 182, 212, 0.3); }
.quiz-btn.lab-mode span.reveal { font-size: 2rem; margin-top: 0; color: var(--cyan); }
.quiz-btn.lab-mode.selected { border-color: var(--cyan); background: rgba(6, 182, 212, 0.15); color: var(--cyan); }
.quiz-btn.lab-mode.correct { border-color: var(--success); background: var(--success); color: white; }
.quiz-btn.lab-mode.correct .figured-bass, .quiz-btn.lab-mode.selected .figured-bass { color: inherit; }

/* COMMANDS */
.command-deck { background: var(--panel); padding: 6px; border-radius: 16px; border: 1px solid var(--panel-border); display: flex; gap: 6px; height: 60px; flex-shrink: 0; box-shadow: 0 -5px 20px rgba(0,0,0,0.2); z-index: 10; }
.cmd-btn { border: none; border-radius: 12px; cursor: pointer; font-weight: 700; font-family: var(--font); transition: transform 0.1s; display: flex; flex-direction: column; align-items: center; justify-content: center; }
.cmd-btn:active { transform: scale(0.95); }
.cmd-btn:disabled { opacity: 0.4; filter: grayscale(1); cursor: not-allowed; }
.btn-listen { flex: 1; background: #334155; color: white; font-size: 0.7rem; border: 1px solid rgba(255,255,255,0.1); }
.btn-action { flex: 2; background: var(--success); color: white; font-size: 1rem; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3); text-transform: uppercase; letter-spacing: 1px; }
.btn-action.next { background: var(--primary); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); }
.icon-lg { font-size: 1.1rem; margin-bottom: 2px; }

.app-container.quiz-mode .btn-listen { display: none; }
.app-container.quiz-mode .btn-action { flex-grow: 1; }
.app-footer { text-align: center; font-size: 0.6rem; color: var(--text-dim); opacity: 0.5; margin-top: 2px; pointer-events: auto; cursor: pointer; transition: opacity 0.2s; }
.app-footer:hover { opacity: 1; color: var(--gold); }
.app-footer:active { transform: scale(0.95); }

/* MODALS */
.modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 2000; backdrop-filter: blur(5px); align-items: center; justify-content: center; perspective: 1000px; }
.modal-overlay.open { display: flex; animation: fadeIn 0.2s; }
.modal { background: #1e293b; padding: 20px; border-radius: 24px; width: 90%; max-width: 400px; border: 1px solid rgba(255,255,255,0.1); text-align: center; box-shadow: 0 25px 50px rgba(0,0,0,0.6); max-height: 85vh; overflow-y: auto; position: relative; transition: transform 0.3s; }
.brand-title { font-size: 1.5rem; font-weight: 900; margin: 0 0 20px 0; letter-spacing: -0.5px; }
.brand-primary { color: var(--text); } .brand-accent { color: var(--primary); }
.toggle-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
.toggle-row:last-child { border: none; }
.settings-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 20px; }
.setting-chip { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 10px 5px; cursor: pointer; font-size: 0.8rem; font-weight: 700; color: var(--text-dim); transition: all 0.2s; display: inline-flex; flex-direction: column; align-items: center; justify-content: center; position: relative; min-height: 60px; }
.setting-chip.active { background: var(--primary); color: white; border-color: var(--primary); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); }
.setting-chip:active { transform: scale(0.95); }
.setting-chip.locked { opacity: 0.5; filter: grayscale(1); }
.setting-chip.locked::after { content: 'ðŸ”’'; position: absolute; top: -5px; right: -5px; background: #333; border-radius: 50%; padding: 2px; font-size: 0.7rem; }
.toggle-switch { position: relative; width: 40px; height: 22px; } .toggle-switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; inset: 0; background: #334155; transition: .3s; border-radius: 22px; } .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background: white; transition: .3s; border-radius: 50%; }
input:checked + .slider { background: var(--primary); } input:checked + .slider:before { transform: translateX(18px); }

/* HUD & BADGES GRID */
.toast-box { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%) translateY(20px); background: var(--panel); border: 1px solid var(--gold); color: var(--gold); padding: 10px 20px; border-radius: 20px; font-weight: 700; font-size: 0.85rem; box-shadow: 0 10px 25px rgba(0,0,0,0.5); z-index: 2100; pointer-events: none; opacity: 0; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); text-align: center; white-space: nowrap; }
.toast-box.show { transform: translateX(-50%) translateY(0); opacity: 1; }
.level-hud { position: fixed; inset: 0; pointer-events: none; z-index: 200; display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0; transform: scale(0.8); transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); text-align: center; }
.level-hud.active { opacity: 1; transform: scale(1); }
.level-hud h1 { font-size: 3rem; margin: 0; color: white; text-shadow: 0 0 30px rgba(251, 191, 36, 0.8), 0 4px 10px black; line-height: 1.2; }

.badges-section { margin-top: 25px; }
.badges-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 16px; border: 1px solid rgba(255,255,255,0.05); }
.badge-item { aspect-ratio: 1/1; background: rgba(255,255,255,0.03); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; filter: grayscale(1) opacity(0.3); transition: all 0.2s; cursor: help; position: relative; border: 1px solid transparent; }
.badge-item.unlocked { filter: grayscale(0) opacity(1); background: rgba(255,255,255,0.08); box-shadow: 0 0 10px rgba(0,0,0,0.3); border-color: rgba(255,255,255,0.1); }
.badge-item.unlocked:hover { transform: scale(1.1); z-index: 10; background: var(--panel); }
.badge-item.set-jazz.unlocked { border-color: var(--gold); box-shadow: 0 0 15px rgba(251, 191, 36, 0.3); }
.badge-item.set-laboratory.unlocked { border-color: var(--cyan); box-shadow: 0 0 15px rgba(6, 182, 212, 0.3); }
.badge-item.set-academy.unlocked { border-color: #e2e8f0; box-shadow: 0 0 15px rgba(226, 232, 240, 0.3); }

.combo-popup { position: fixed; top: 40%; left: 50%; transform: translate(-50%, -50%) scale(0); pointer-events: none; z-index: 150; text-align: center; transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); opacity: 0; }
.combo-popup.show { transform: translate(-50%, -50%) scale(1); opacity: 1; }
.combo-popup h2 { font-size: 3rem; margin: 0; color: white; text-shadow: 0 5px 20px rgba(0,0,0,0.5); -webkit-text-stroke: 2px var(--primary); font-weight: 900; font-style: italic; }
.combo-popup p { margin: 0; color: var(--gold); font-weight: 800; font-size: 1.2rem; text-transform: uppercase; }

.coach-box { margin-bottom: 15px; display: flex; flex-direction: column; align-items: center; }
.coach-avatar { font-size: 2rem; margin-bottom: 8px; animation: pop 1s infinite alternate; }
.coach-bubble { background: #334155; color: white; padding: 12px; border-radius: 16px; position: relative; font-size: 0.85rem; line-height: 1.4; border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 4px 10px rgba(0,0,0,0.3); max-width: 100%; }
.coach-bubble:after { content: ''; position: absolute; top: -8px; left: 50%; transform: translateX(-50%); border-width: 0 8px 8px; border-style: solid; border-color: #334155 transparent; display: block; width: 0; }
.coach-bubble strong { color: var(--gold); font-weight: 800; }
.coach-tag { display: inline-block; background: var(--primary); color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.6rem; font-weight: 800; text-transform: uppercase; margin-bottom: 5px; }
.coach-tag.context-badge { text-transform: none; font-size: 0.75rem; letter-spacing: 0; }

.history-box { background: rgba(0,0,0,0.2); border-radius: 12px; padding: 10px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.05); position: relative; }
.chart-limit-line { position: absolute; top: 50%; left: 10px; right: 10px; height: 1px; background: rgba(255,255,255,0.1); border-top: 1px dashed rgba(255,255,255,0.3); pointer-events: none; }
.chart-container { display: flex; align-items: flex-end; justify-content: space-between; height: 80px; gap: 6px; z-index: 1; position: relative; }
.chart-col { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 4px; height: 100%; justify-content: flex-end; }
.chart-track { width: 100%; flex: 1; background: rgba(255,255,255,0.05); border-radius: 4px; display: flex; align-items: flex-end; overflow: hidden; min-height: 60px; }
.chart-bar { width: 100%; transition: height 0.5s ease-out; min-height: 0; }
.chart-label { font-size: 0.55rem; color: var(--text-dim); margin-top: 2px;}
.stat-item { margin-bottom: 6px; } .stat-header { display: flex; justify-content: space-between; font-size: 0.75rem; margin-bottom: 2px; }
.stat-track { height: 5px; background: rgba(255,255,255,0.1); border-radius: 3px; overflow: hidden; } .stat-fill { height: 100%; }

/* PROFIL & MAITRISE */
.profile-header { text-align: center; margin-bottom: 20px; }
.profile-avatar { font-size: 3rem; margin-bottom: 10px; animation: float 3s ease-in-out infinite; display: inline-block; transition: 0.3s; padding: 10px; border-radius: 50%; border: 2px solid transparent; }
.profile-title { font-size: 1.5rem; font-weight: 900; color: white; margin: 0; }
.profile-subtitle { color: var(--gold); text-transform: uppercase; letter-spacing: 1px; font-size: 0.75rem; font-weight: 800; margin-top: 5px; padding: 0 10px; line-height: 1.4; white-space: normal; }
.profile-tech-row { font-family: monospace; font-size: 1.2rem; font-weight: 900; color: var(--tier-color); text-shadow: 0 0 10px var(--tier-shadow); margin-top: 5px; display: flex; align-items: center; justify-content: center; gap: 8px; }
.profile-lore-tiny { font-size: 0.65rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 2px; margin-top: 4px; opacity: 0.8; }
.xp-big-container { background: rgba(0,0,0,0.3); height: 20px; border-radius: 10px; margin: 20px 0 5px 0; border: 1px solid rgba(255,255,255,0.1); overflow: hidden; position: relative; }
.xp-big-fill { height: 100%; background: linear-gradient(90deg, var(--primary), var(--accent)); width: 0%; transition: width 1s ease-out; }
.xp-text { display: flex; justify-content: space-between; font-size: 0.7rem; color: var(--text-dim); margin-bottom: 20px; }
.stat-grid-profile { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 25px; }
.stat-card { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 16px; text-align: center; border: 1px solid rgba(255,255,255,0.05); }
.stat-card h3 { margin: 0; font-size: 1.5rem; color: white; }
.stat-card p { margin: 5px 0 0 0; font-size: 0.7rem; color: var(--text-dim); text-transform: uppercase; }

.btn-prestige { background: linear-gradient(135deg, #fbbf24 0%, #b45309 100%); border: 1px solid #fbbf24; color: white; padding: 15px; width: 100%; border-radius: 16px; font-size: 1.1rem; font-weight: 900; text-transform: uppercase; letter-spacing: 1px; box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4); cursor: pointer; position: relative; overflow: hidden; transition: all 0.3s; display: flex; flex-direction: column; align-items: center; justify-content: center; }
.btn-prestige:hover { transform: scale(1.02); box-shadow: 0 0 25px rgba(251, 191, 36, 0.6); }
.btn-prestige:active { transform: scale(0.98); }
.btn-prestige:disabled { background: #334155; border-color: #475569; color: #64748b; box-shadow: none; cursor: not-allowed; filter: grayscale(1); }
.btn-prestige .shiny { position: absolute; top: 0; left: -100%; width: 50%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent); transform: skewX(-20deg); animation: shine 3s infinite; }
.prestige-main-txt { font-size: 1.2rem; font-weight: 900; }
.prestige-sub-txt { font-size: 0.75rem; opacity: 1; margin-top: 4px; font-weight: 700; color: rgba(255,255,255,0.9); }

/* CODEX GRIMOIRE - REPLACED WITH CODEX 2.0 CARD */
.codex-card { aspect-ratio: 0.8; background: linear-gradient(145deg, rgba(30, 41, 59, 0.9), rgba(15, 23, 42, 0.95)); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; overflow: hidden; cursor: pointer; transition: transform 0.1s; box-shadow: 0 4px 10px rgba(0,0,0,0.3); transform-style: preserve-3d; }
.codex-card:active { transform: scale(0.95) !important; }
.codex-card.locked { filter: grayscale(1) opacity(0.5); cursor: not-allowed; }
.codex-card.locked::after { content: 'ðŸ”’'; font-size: 1.5rem; opacity: 0.5; }
.codex-card-symbol { font-size: 2rem; font-weight: 900; color:white; z-index: 2; text-shadow: 0 2px 10px rgba(0,0,0,0.5); margin-bottom: 5px; }
.codex-card-title { font-weight: 700; font-size: 0.75rem; text-align: center; color: var(--text-dim); z-index: 2; text-transform: none !important; }
.codex-holo { position: absolute; inset: 0; background: linear-gradient(115deg, transparent 20%, rgba(255,255,255,0.1) 40%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 60%, transparent 80%); opacity: 0; pointer-events: none; z-index: 10; mix-blend-mode: overlay; transition: opacity 0.2s; transform: translateX(-100%); }
.codex-card.unlocked:hover .codex-holo { opacity: 1; animation: holoSweep 2s infinite linear; }
.codex-card.unlocked { border-color: var(--primary-glow); }

/* GOLD PLAY BUTTON */
.btn-gold-play { width: 50px; height: 50px; border-radius: 50%; background: rgba(251, 191, 36, 0.1); border: 1px solid var(--gold); color: var(--gold); display: flex; align-items: center; justify-content: center; font-size: 1.2rem; cursor: pointer; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); margin-left: auto; box-shadow: 0 0 10px rgba(251, 191, 36, 0.1); }
.btn-gold-play:hover { background: var(--gold); color: #000; box-shadow: 0 0 25px rgba(251, 191, 36, 0.6); transform: scale(1.1); }
.btn-gold-play:active { transform: scale(0.9); }
.btn-gold-play.playing { animation: pulseGold 0.5s infinite; background: var(--gold); color: #000; }
@keyframes pulseGold { 0% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(251, 191, 36, 0); } 100% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0); } }

.cd-vis { height: 100px; background: rgba(0,0,0,0.3); border-radius: 12px; margin-bottom: 15px; position: relative; overflow: hidden; border: 1px solid rgba(255,255,255,0.1); }
.cd-lore { font-size: 0.9rem; line-height: 1.6; color: #cbd5e1; flex: 1; overflow-y: auto; padding-right: 5px; }
.cd-flavor { font-style: italic; border-left: 3px solid var(--gold); padding-left: 15px; color: #e2e8f0; font-size: 1rem; }
.cd-theory { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 12px; font-size: 0.8rem; }
.cd-theory strong { color: var(--text); display: block; margin-bottom: 2px; }
.cd-coach { background: rgba(30, 41, 59, 0.8); border: 1px solid rgba(255,255,255,0.1); padding: 12px; border-radius: 12px; color: var(--text-dim); font-size: 0.8rem; display: flex; gap: 10px; align-items: flex-start; margin-top: 10px; }
.cd-coach span:first-child { font-size: 1.2rem; }

/* ACTION BUTTON */
.btn-action-train { width: 100%; padding: 12px; border-radius: 12px; border: none; background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); color: white; font-weight: 800; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; cursor: pointer; margin-top: 15px; box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4); transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; }
.btn-action-train:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(99, 102, 241, 0.6); }
.btn-action-train:active { transform: translateY(0); }

.cd-nav { display: flex; justify-content: space-between; margin-top: auto; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.05); }
.nav-btn-round { width: 36px; height: 36px; border-radius: 50%; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); color: var(--text); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.2s; }
.nav-btn-round:hover { background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.3); }
.nav-btn-round:disabled { opacity: 0.3; cursor: default; }

.lb-sub-nav { display: flex; justify-content: center; gap: 20px; margin-bottom: 15px; border-bottom: 1px solid var(--panel-border); padding-bottom: 5px; }
.lb-period-btn { background: transparent; border: none; color: var(--text-dim); font-size: 0.8rem; font-weight: 700; text-transform: uppercase; cursor: pointer; padding: 5px 10px; position: relative; transition: color 0.2s; }
.lb-period-btn:hover { color: white; }
.lb-period-btn.active { color: var(--gold); }
.lb-period-btn.active::after { content: ''; position: absolute; bottom: -6px; left: 0; width: 100%; height: 2px; background: var(--gold); box-shadow: 0 -2px 5px rgba(251, 191, 36, 0.5); }

/* BADGE LIGHTBOX */
.badge-lightbox .modal { background: rgba(30, 41, 59, 0.75); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37); }
.badge-lightbox .unlocked { color: var(--success); border: 1px solid rgba(16, 185, 129, 0.3); background: rgba(16, 185, 129, 0.1); }
.badge-lightbox .locked { color: var(--text-dim); border: 1px solid rgba(255,255,255,0.1); }

/* GHOST PLAYERS STYLES */
.leaderboard-row.ghost { opacity: 0.8; border: 1px dashed rgba(255,255,255,0.2) !important; background: rgba(165, 243, 252, 0.05) !important; }
.leaderboard-row.ghost:hover { background: rgba(165, 243, 252, 0.1) !important; }

@keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
@keyframes shine { 0% { left: -100%; } 20% { left: 200%; } 100% { left: 200%; } }
@keyframes pop { 0% { transform: scale(0.9); } 100% { transform: scale(1.1); } }
@keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
@keyframes pulseFire { 0%{transform:scale(1);} 50%{transform:scale(1.1);} 100%{transform:scale(1);} }
@keyframes pulseCorrection { 0%{transform:scale(1); box-shadow: 0 0 0 2px #fbbf24, 0 0 20px rgba(251, 191, 36, 0.4);} 50%{transform:scale(1.03); box-shadow: 0 0 0 4px #fbbf24, 0 0 40px rgba(251, 191, 36, 0.8);} 100%{transform:scale(1); box-shadow: 0 0 0 2px #fbbf24, 0 0 20px rgba(251, 191, 36, 0.4);} }
@keyframes heartbeat { 0%{opacity:0.3;} 50%{opacity:0.7;} 100%{opacity:0.3;} }
@keyframes fadeIn { from{opacity:0} to{opacity:1} }
@keyframes holoSweep { 0% { transform: translateX(-100%) rotate(25deg); } 100% { transform: translateX(200%) rotate(25deg); } }

/* --- CHALLENGE V5 UPDATES --- */
.daily-card { background: linear-gradient(135deg, #b45309 0%, #fbbf24 100%); border-radius: 16px; padding: 20px; box-shadow: 0 10px 25px rgba(251, 191, 36, 0.3); cursor: pointer; transition: transform 0.2s; text-align: center; border: 1px solid rgba(255,255,255,0.2); }
.daily-card:active { transform: scale(0.98); }
.create-form-group { text-align: left; }
.create-form-group label { font-size: 0.75rem; color: var(--text-dim); text-transform: uppercase; font-weight: 700; display: block; margin-bottom: 5px; }
.report-score-circle { width: 140px; height: 140px; border-radius: 50%; border: 6px solid white; display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 20px auto; background: rgba(0,0,0,0.2); box-shadow: 0 0 40px rgba(0,0,0,0.5); }
.mistake-row { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-radius: 8px; background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.2); margin-bottom: 6px; cursor: pointer; transition: background 0.2s; }
.mistake-row:hover { background: rgba(239, 68, 68, 0.2); }
.challenge-tab-content { animation: fadeIn 0.3s ease; }

@media (min-width: 769px) { .grid-c { grid-template-columns: repeat(3, 1fr); } }
@media (max-width: 768px) { .game-area { grid-template-columns: 1fr; grid-template-rows: 1.5fr 1fr; } .header-left { flex: 1; min-width: 0; gap: 8px; } .rank-text { display: flex; min-width: 0; } .lvl-pill { display: none; } .stats-cluster { display: none; } .rank-title { font-size: 0.8rem; } .pad-main { font-size: 0.9rem; } .pad-sub { font-size: 0.5rem; } .level-hud h1 { font-size: 2rem; } .quiz-target { font-size: 3rem; } .quiz-btn { font-size: 1.5rem; } }
@media (max-height: 700px) { .app-container { gap: 5px; padding: 5px; } header { padding: 4px 8px; min-height: 40px; } .rank-icon { font-size: 1.2rem; } .tools-bar { height: 32px; } .mode-opt { padding: 2px 8px; font-size: 0.65rem; } .command-deck { height: 50px; padding: 4px; } .icon-lg { font-size: 0.9rem; margin-bottom: 0; } .cmd-btn span { font-size: 0.65rem; } .btn-action { font-size: 0.9rem; } .panel-label { margin-bottom: 4px; } }

/* --- LEVEL TIMELINE (VERTICAL) --- */
.level-timeline-container {
    display: flex;
    flex-direction: column-reverse; /* Pour afficher du niveau 1 en bas au niveau actuel en haut */
    align-items: center;
    margin: 20px 0;
    max-height: 200px; /* Hauteur max avec scroll */
    overflow-y: auto;
    padding: 10px;
    background: rgba(0,0,0,0.2);
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.05);
    /* --- AJOUTS POUR CACHER LES BARRES --- */
    scrollbar-width: none;  /* Pour Firefox */
    -ms-overflow-style: none;  /* Pour IE/Edge */
    }

    /* Pour Chrome, Safari, Opera */
    .level-timeline-container::-webkit-scrollbar {
    display: none;
}

.timeline-node {
    display: flex;
    align-items: center;
    gap: 15px;
    opacity: 0.5; /* Niveaux passÃ©s un peu estompÃ©s */
    margin-bottom: 15px;
    width: 100%;
    justify-content: center;
}

.timeline-node.current {
    opacity: 1;
    transform: scale(1.1);
    margin: 20px 0;
    background: rgba(99, 102, 241, 0.15);
    padding: 10px;
    border-radius: 12px;
    border: 1px solid var(--primary);
    box-shadow: 0 0 20px rgba(99, 102, 241, 0.2);
}

.node-icon {
    font-size: 1.2rem;
    width: 40px;
    height: 40px;
    background: rgba(255,255,255,0.05);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid rgba(255,255,255,0.1);
}

.timeline-node.current .node-icon {
    background: var(--primary);
    color: white;
    font-size: 1.5rem;
    border-color: white;
    box-shadow: 0 0 10px var(--primary);
}

.node-info {
    text-align: left;
    display: flex;
    flex-direction: column;
}

.node-lvl {
    font-size: 0.6rem;
    text-transform: uppercase;
    color: var(--text-dim);
    font-weight: 700;
}

.node-title {
    font-size: 0.9rem;
    font-weight: 700;
    color: white;
}

.timeline-connector {
    width: 2px;
    height: 15px;
    background: rgba(255,255,255,0.1);
    margin: -10px 0 5px 0; /* Ajustement pour lier les noeuds */
}

/* --- PROFIL STYLE "CLASH ROYALE" (COMPACT HEADER + TIMELINE) --- */

/* 1. Le conteneur principal sans scroll global */
#modalProfile .modal {
    padding: 0; /* On enlÃ¨ve le padding pour coller aux bords */
    height: 80vh; /* Hauteur fixe importante */
    max-height: 600px;
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Pas de scrollbar sur la fenÃªtre principale */
    background: #0f172a;
}

/* 2. Le Header "Mini-Banner" (Fixe en haut) */
.profile-header-compact {
    background: #1e293b;
    padding: 20px 20px 15px 20px; /* Plus d'espace en haut */
    position: relative;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    display: block;
    align-items: center;
    gap: 15px;
    flex-shrink: 0; /* Ne rÃ©trÃ©cit pas */
    z-index: 10;
    box-shadow: 0 4px 20px rgba(0,0,0,0.2);
}

/* Conteneur Flex pour Avatar + Infos (Partie Haute) */
.profile-top-row {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 15px;
    padding-right: 30px; /* IMPORTANT: Marge Ã  droite pour Ã©viter le bouton X */
}


.profile-avatar-small {
    font-size: 2rem;
    width: 60px;
    height: 60px;
    background: rgba(255,255,255,0.05);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid var(--tier-color, #fff);
    box-shadow: 0 0 10px var(--tier-shadow, rgba(0,0,0,0));
}

.profile-info-compact {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.profile-name-row {
    display: flex;
    align-items: center;
    gap: 10px;
}

.profile-stats-line {
    font-size: 0.7rem;
    color: var(--text-dim);
    margin-top: 4px;
    display: flex;
    gap: 10px;
}

.stat-pill {
    background: rgba(255,255,255,0.05);
    padding: 2px 8px;
    border-radius: 4px;
    font-weight: 600;
}

/* 3. La Timeline (Zone Scrollable) */
.timeline-scroll-area {
    flex: 1; /* Prend tout le reste de la place */
    overflow-y: auto; /* Scroll uniquement ici */
    overflow-x: hidden;
    padding: 20px;
    background: linear-gradient(180deg, #0f172a 0%, #1e1b4b 100%); /* Petit dÃ©gradÃ© sympa */
    
    /* Cache les barres de dÃ©filement */
    scrollbar-width: none;
}
.timeline-scroll-area::-webkit-scrollbar { display: none; }

/* Les Noeuds de la Timeline */
.tl-node {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 10px;
    margin-bottom: 0; /* CollÃ© pour la ligne */
    position: relative;
    opacity: 0.5; /* PassÃ© estompÃ© */
    transition: all 0.3s;
}

/* Ligne connectrice verticale */
.tl-node::before {
    content: '';
    position: absolute;
    left: 29px; /* CentrÃ© sous l'icone (40px/2 + padding) */
    top: 40px;
    bottom: -20px; /* Va jusqu'au suivant */
    width: 2px;
    background: rgba(255,255,255,0.1);
    z-index: 0;
}
.tl-node:last-child::before { display: none; } /* Pas de ligne aprÃ¨s le dernier (niveau 1) */

.tl-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #334155;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    z-index: 1; /* Dessus la ligne */
    border: 2px solid #475569;
}

.tl-content {
    background: rgba(255,255,255,0.03);
    padding: 8px 12px;
    border-radius: 8px;
    flex: 1;
}

/* Le Niveau Actuel (Highlight) */
.tl-node.current {
    opacity: 1;
    margin: 20px 0 30px 0; /* Un peu d'espace autour */
    transform: scale(1.05);
}

.tl-node.current .tl-icon {
    background: var(--primary);
    border-color: white;
    box-shadow: 0 0 20px var(--primary);
    width: 50px; height: 50px; font-size: 1.5rem; /* Plus gros */
    left: -5px; position: relative; /* Recentrage */
}

.tl-node.current .tl-content {
    background: rgba(99, 102, 241, 0.15);
    border: 1px solid var(--primary);
}

/* Le Footer Prestige (Fixe en bas) */
.profile-footer-fixed {
    padding: 15px;
    background: #1e293b;
    border-top: 1px solid rgba(255,255,255,0.1);
    z-index: 10;
}

/* Nouvelle organisation des Infos MaÃ®trise */
.mastery-meta-row {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.8rem;
    color: var(--tier-color);
    font-weight: 700;
    margin-top: 4px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.mastery-icon-badge {
    background: rgba(255,255,255,0.1);
    width: 24px; height: 24px;
    border-radius: 4px;
    display: flex; align-items: center; justify-content: center;
    font-size: 1rem;
}

/* Barre d'XP intÃ©grÃ©e */
.profile-xp-track {
    height: 6px;
    background: rgba(255,255,255,0.1);
    border-radius: 3px;
    margin: 10px 0 8px 0;
    overflow: hidden;
    position: relative;
}
.profile-xp-fill {
    height: 100%;
    background: var(--tier-color, var(--primary)); /* Couleur dynamique selon le rang */
    width: 0%;
    transition: width 0.5s ease-out;
    box-shadow: 0 0 10px var(--tier-shadow);
}

/* Stats Explicites (Grille) */
.profile-stats-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-top: 5px;
}

.mini-stat-box {
    background: rgba(255,255,255,0.03);
    border-radius: 8px;
    padding: 6px 10px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.mini-stat-icon { font-size: 1.1rem; opacity: 0.8; }
.mini-stat-info { display: flex; flex-direction: column; line-height: 1; }
.mini-stat-val { font-weight: 800; font-size: 0.9rem; color: white; }
.mini-stat-label { font-size: 0.55rem; text-transform: uppercase; color: var(--text-dim); margin-top: 3px; }

/* Timeline Connector (Le fil qui relie le header Ã  la liste) */
.timeline-connector-top {
    position: absolute;
    left: 50px; /* Doit s'aligner avec le centre de l'avatar (20px pad + 30px demi-width) */
    bottom: -20px; /* DÃ©passe du header */
    width: 2px;
    height: 20px;
    background: rgba(255,255,255,0.1);
    z-index: 0;
}

/* --- TUTORIAL PAGINATION --- */
.tuto-dot {
    width: 10px; 
    height: 10px; 
    background: rgba(255,255,255,0.1); 
    border-radius: 50%; 
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border: 1px solid rgba(255,255,255,0.05);
}
.tuto-dot.active {
    background: var(--gold); 
    box-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
    transform: scale(1.2);
    border-color: var(--gold);
}

/* --- WALKTHROUGH TUTORIAL (SPOTLIGHT) --- */

/* Le projecteur : une boite transparente avec une ombre immense */
.tour-spotlight {
    position: fixed;
    border-radius: 12px;
    box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.85); /* L'ombre fait le noir autour */
    z-index: 3000;
    pointer-events: none; /* Permet de cliquer au travers si besoin */
    transition: all 0.4s cubic-bezier(0.25, 1, 0.5, 1);
    opacity: 0;
    /* Anneau dorÃ© pour bien marquer la cible */
    border: 2px solid var(--gold);
}
.tour-spotlight.active { opacity: 1; }

/* La bulle d'explication */
/* --- STYLE MODERNE GLASSMORPHISM --- */
.tour-tooltip {
    position: fixed;
    z-index: 3001;
    
    /* Effet Verre FumÃ© Moderne */
    background: rgba(15, 23, 42, 0.85); /* Fond sombre Ã  85% d'opacitÃ© */
    backdrop-filter: blur(12px);         /* Flou de l'arriÃ¨re plan */
    -webkit-backdrop-filter: blur(12px); /* CompatibilitÃ© Safari */
    border: 1px solid rgba(255, 255, 255, 0.15); /* Bordure fine et discrÃ¨te */
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5); /* Ombre profonde */
    
    width: 320px; /* Largeur fixe pour Ã©viter que Ã§a change tout le temps */
    max-width: 90vw; /* SÃ©curitÃ© mobile */
    padding: 20px;
    border-radius: 20px;
    
    opacity: 0;
    /* Transition fluide pour le mouvement */
    transition: opacity 0.3s ease, top 0.4s cubic-bezier(0.2, 0.8, 0.2, 1), left 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
    pointer-events: none;
}

/* La flÃ¨che se place dÃ©sormais "sur le bord" de la boite */
.tour-arrow { 
    position: absolute; 
    width: 16px; 
    height: 16px; 
    background: #1e293b; /* MÃªme couleur que le fond de la bulle (attention si glassmorphism) */
    /* Si glassmorphism utilisÃ© : background: rgba(15, 23, 42, 0.9); */
    transform: rotate(45deg); 
    z-index: -1; /* DerriÃ¨re le contenu */
}

.tour-tooltip.active { opacity: 1; pointer-events: auto; }

.tour-tooltip h3 {
    margin-top: 0;
    padding-right: 20px; /* Espace de sÃ©curitÃ© Ã  droite */
    font-size: 1.1rem;   /* Titre un peu plus gros */
    color: var(--gold);
}
.tour-tooltip p { color: #cbd5e1; font-size: 0.9rem; line-height: 1.5; margin: 0 0 20px 0; }

.tour-footer { display: flex; justify-content: space-between; align-items: center; }
#tour-step-count { font-size: 0.75rem; color: var(--text-dim); font-weight: 700; }

.tour-btn { border: none; padding: 8px 16px; border-radius: 8px; font-weight: 700; cursor: pointer; font-size: 0.8rem; transition: 0.2s; }
.tour-btn.skip { background: transparent; color: var(--text-dim); }
.tour-btn.skip:hover { color: white; }
.tour-btn.next { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(99, 102, 241, 0.4); }
.tour-btn.next:hover { transform: translateY(-2px); }

/* FlÃ¨che de la bulle (Optionnel, simpliste ici) */
.tour-arrow { position: absolute; width: 12px; height: 12px; background: #1e293b; transform: rotate(45deg); border-left: 1px solid rgba(255,255,255,0.1); border-top: 1px solid rgba(255,255,255,0.1); }

/* --- 2. CORRECTION DÃ‰BORDEMENT MODALES --- */
.modal-content {
    /* Ces 3 lignes rÃ¨glent le problÃ¨me d'affichage */
    max-height: 85vh;       /* Laisse une marge de sÃ©curitÃ© en haut et en bas */
    overflow-y: auto;       /* Active le scroll vertical uniquement si nÃ©cessaire */
    overflow-x: hidden;     /* INTERDIT le scroll horizontal (coupe ce qui dÃ©passe) */

    /* Optimisation visuelle */
    box-sizing: border-box;
    padding-right: 2px;     /* Ã‰vite que le texte colle Ã  la barre de dÃ©filement */
}

/* --- OPTIMISATION MOBILE ARÃˆNE (Version Finale) --- */
@media (max-width: 600px) {
    /* 1. Les Onglets Principaux (Classement, DÃ©fi...) */
    .lb-sub-nav {
        flex-wrap: wrap; 
        height: auto;
        justify-content: center;
        padding: 5px 0;
        gap: 8px; 
        /* CRUCIAL : On pousse le contenu du dessous */
        margin-bottom: 25px; 
        border-bottom: none; /* Plus joli sans la ligne en mode grille */
    }

    .lb-period-btn {
        /* FORCE 2 BOUTONS PAR LIGNE (45% chq + gap) */
        flex: 1 0 45%; 
        
        text-align: center;
        display: flex; justify-content: center; align-items: center;
        
        /* Texte plus petit et bouton plus compact */
        font-size: 0.75rem;
        padding: 8px 4px;
        border-radius: 8px;
        
        /* Petit fond pour mieux voir les boutons tactiles */
        background: rgba(255,255,255,0.03); 
        border: 1px solid rgba(255,255,255,0.05);
    }
    
    /* Style actif pour les boutons mobiles (encadrÃ© dorÃ©) */
    .lb-period-btn.active {
        background: rgba(251, 191, 36, 0.1);
        border-color: var(--gold);
    }
    /* On retire la barre de soulignement desktop qui fait bizarre sur 2 lignes */
    .lb-period-btn.active::after {
        display: none; 
    }

    /* 2. Les Filtres du dessous (Chrono, Sprint, Inverse) */
    #c-tab-arcade .mode-opt {
        font-size: 0.7rem; /* Un peu plus petit */
        padding: 6px 2px;  /* Moins large pour que les 3 tiennent bien */
        flex: 1;           /* Distribution Ã©quitable */
        white-space: nowrap;
    }

    /* DANS styles.css (Tout en bas) */
}

/* --- BARRE DE PROGRESSION (GLOBAL) --- */
.challenge-progress-container {
    position: fixed;
    top: 0; 
    left: 0; 
    width: 100%; 
    height: 12px;
    background-color: #0f172a; 
    z-index: 2147483647; /* Toujours au-dessus */
    display: none; /* ActivÃ© par JS via display: flex */
    flex-direction: row;
    gap: 2px;
    padding: 0 2px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.5);
}

.challenge-segment {
    flex: 1;
    background: #334155; 
    height: 100%;
    border-radius: 0 0 4px 4px;
    transition: background 0.2s;
}

.challenge-segment.current {
    background: white;
    box-shadow: 0 0 10px white;
}

.challenge-segment.correct { background: var(--success); }
.challenge-segment.wrong { background: var(--error); }

/* --- NETTOYAGE UI --- */
.hidden-force { display: none !important; }
#interstitialOverlay { display: none !important; }

/* Classe utilitaire pour cacher le score classique proprement */
.hidden-force { display: none !important; }

/* --- Ã‰CRAN INTERSTITIEL (Transition) --- */
.interstitial-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--bg); /* Fond uni pour cacher l'arriÃ¨re-plan */
    z-index: 20000;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

.interstitial-overlay.active {
    opacity: 1;
    pointer-events: all;
}

.interstitial-content h1 {
    font-size: 2rem;
    color: var(--text);
    text-transform: uppercase;
    letter-spacing: 2px;
}

/* --- FIX: CACHER LE GROS COMPTEUR DROIT EN DÃ‰FI --- */
/* On utilisera cette classe via JS */
.hidden-force {
    display: none !important;
}

/* --- ICÃ”NES D'AIDE DANS LES MODALES --- */
.modal-help-icon {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid var(--text-dim);
    color: var(--text-dim);
    font-size: 0.9rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
    flex-shrink: 0;
}

.modal-help-icon:hover {
    background: rgba(99, 102, 241, 0.2);
    border-color: var(--primary);
    color: var(--primary);
    transform: scale(1.1);
}

.modal-help-icon:active {
    transform: scale(0.95);
}

}